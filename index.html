<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <title></title>
</head>
<body>
    <h1>Map</h1>
    <svg id="map" style="margin: 0 auto; display: block;" width="1000" height="1000"></svg>
    <script type="text/javascript">
    const map = d3.select('#map');
    var scale = 40.0;
    d3.json("data/streets.json", function (data) {
        //console.log(data)
        var a;
        var b;
        var l;
        for (a = 0; a < data.length; a++) {
            l = data[a];
            for (b = 0; b < l.length - 1; b++) {
                map.append('line')
                    .style('stroke', 'black')
                    .style('stroke-width', '2')
                    .attr('x1', l[b].x * scale)
                    .attr('x2', l[b + 1].x * scale)
                    .attr('y1', l[b].y * scale)
                    .attr('y2', l[b + 1].y * scale);
                    //console.log(l[b+1].x);
                }
            }
    });
    d3.csv("data/pumps.csv", function (data) {
        //console.log(data);
        var i = 0;
        for (i = 0; i < data.length; i++) {
            map.append('circle')
                .attr('cx', data[i].x*scale)
                .attr('cy', data[i].y*scale)
                .attr('r', '5')
                .attr('fill', 'steelblue');
        }
    });
    //slider to get ending date for showing the data

    var endDate = 10;
    var deaths = 0;
    //need to get a number to tell how many of the deaths to show
    d3.csv("data/deathdays.csv", function (data) {
        console.log(data);
        var d = 0;
        for (d = 0; d < endDate; d++) {
            deaths += Number(data[d].deaths);
            console.log(deaths);
        }

    });
    console.log('deaths to show: ' + deaths);
    d3.csv("data/deaths_age_sex.csv", function (data) {
        console.log(data);
        for (d = 0; d < deaths; d++) {
            map.append('circle')
                .attr('cx', data[d].x*scale)
                .attr('cy', data[d].y*scale)
                .attr('r', '5')
                .attr('fill', 'red');
        }

    });
    </script>

</body>
</html>
